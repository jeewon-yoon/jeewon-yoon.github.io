---
title: "실험설계에서 일반화 선형 혼합효과 모형"
excerpt: "Linear mixed-effects model & Generalized linear mixed-effects model"
permalink: /projects/2024-08-04-project-2/
layout: single
classes: wide
---

## *연구배경:

<style>
</style>

선형혼합효과 모형(hierarchical linear model / multi-level model)은 연속변인인 종속변인을 고정효과와 무선효과의 합으로 표현한 통계모형입니다. 

이 모형은 종단연구와 같이 자료 추출과정상의 특성으로 반응이 독립성 가정을 만족하지 못하는 때에 사용됩니다. 실제로 종속변인이나 데이터들은 대부분 독립성 가정이 충족되기 어렵습니다. 

예를 들어 학생들을 대상으로 조사하게 되면 각 학생이 속한 학급, 학교, 지역 등으로 학생들을 특성에 따라 그룹으로 묶을 수 있습니다. 따라서 그룹의 구조가 각 데이터(학생 1명)들이 독립적이지 않음을 보여주며  위계적인 특성들 또는 서로 상관이 있어보이는 특성들로 인한
효과를 잡아내기 위해 무선효과를 사용합니다. 

혼합효과는 hierarchichal 또는 교차무선효과로 표현합니다.

먼저 교차무선효과에 대해서 이야기한 Baayen는 혼합효과모형은 무선효과를 검증하기 위해 사용되며 혼합효과모형을 통해 연구자가 데이터 구조에 미치는 효과 또는 영향에 대한 요인들을
동시에 고려할 수 있다고 하였습니다. 무엇보다 혼합효과모형은 데이터가 누락된 경우에도 모델이 견고하여 데이터가
누락되지 않은 경우와 비교하였을 때 검정력의 차이가 크지 않았습니다. 1종 오류의 비율 역시 결과가 유의수준만큼
나왔습니다. 

일반화 선형 혼합효과 모형에 대해 Jaeger의
논문에서는 범주변인을 사용할 때 변량분석(ANOVA) 대신 일반화 선형 혼합효과 모형을 써야 하는 이유와
장점에 대해서 제시하였습니다. Mixed logit model은 logistic regression의 장점과 함께 무선효과(random
effects)의 강점을 모두 보유하고 ANOVA보다 더 높은 검정력을 보입니다.

선형 혼합효과 모형에 대해 연구자가 가정하는 상황에서 필요한 참가자와 문항 수를 결정하기 위한 정보를
제공해야 할 필요성이 있기 때문에 몬테카를로 시뮬레이션을 통해 실험에 적합한 문항 수 또는 참가자 수를 알아보고자 합니다. 일반화 선형 혼합효과 모형도 이와 같은 정보가 부족하므로 똑같이 시뮬레이션을
통해 정보를 제공합니다.

먼저 설명드린 선형혼합효과모형과 일반화 선형혼합효과
모형의 차이에 대해 짚어보겠습니다. 두 모형의 차이는 연결함수입니다. 선형혼합효과 모형은 종속변인이 연속형인
경우 사용이 되는 연결함수가 항등함수의 일종인 일반화 선형 혼합효과모형의 일종이라고 볼 수 있습니다. 

일반화 선형 혼합효과모형의 장점은 연결함수를 사용함으로써
종속변인의 분포적 가정이 정규분포에 국한되지 않는다는 것입니다. 모형은 이와 같은 형태를 취합니다.

다음은 maximal model에
대해 알아보겠습니다. Maximal 모형은 연구자가 관심있는 효과가 아닐지라도 가장 복잡한 모형으로부터 효과를
검증합니다. 대신 검정력을 잃게 된다는 단점이 있습니다. 두 모형간
비교를 위해 우도비검정과 Wald test를 이용하였습니다. 먼저 우도비검정은
두 모형의 적합도를 나타내는 편차 차이가 카이제곱분포를 따른다는 가정을 기반으로 하며 동일한 구조의 모형을 비교할 때 사용하는 검정방법입니다.
Wald test는 실험조건효과인 고정효과에 대한 가설검정을 위해 사용되는 방법입니다. 검정통계량 Twald는 추정값 베타를 그 표준오차로 나눈 값을 사용합니다. 표본의 크기가 충분히 클 때 Twald는 영가설 아래에서 z분포를 따른다는 가정을 기반으로 합니다.



![](C:\Users\elley\AppData\Roaming\marktext\images\2024-08-25-16-06-03-image.png)





먼저 선형혼합 효과 모형에 대해 몬테카를로 시뮬레이션을
시행하였습니다. 총 12조건에서 각 조건마다 1000개의 데이터 셋을
생성하였고 maximal model인 m1과 m1의 영가설모델, random intercept만 있는 m2모형과 m2모형의 영가설모델을 만들었습니다. 이후 maximal model인 m1 모형에 대한 Wald검정과 영가설 모델을 우도비검정으로 비교하였습니다. 또한 모형비교과정으로 m1, m2 모형 중 선택된 하나에 대한 Wald검정과 우도비검정을 실시하였습니다. 먼저 rmse값은 참가자수 문항수가 작으면 작을수록 추정값이 부정확하므로 rmse값이 커지고 참가자수,문항수가 늘어날수록 값이 작아지는 경향을 보입니다.
1종 오류 비율은 유의수준을 0.05로 통제하므로 이상적인 경우에 0.05에 가깝습니다. 그림을 보면 우도비검정이 유의수준에 더 근접하므로 wald검정보다 선호되는 검정방법이라고 할 수 있습니다. 또 한편으로는 Wald검정법이 우도비검정보다 보수적인 검정법이라고 해석할 수 있습니다. 마지막으로
검정력은 큰값을 가질수록 더 이상적인 모델입니다. 그림을 보면 우도비검정이 wald검정력보다 높으므로 wald검정이 선호된다고 할 수 있습니다. 또한 참가자수/문항수가 많아질수록 검정력이 커집니다.

다음 일반화 선형 혼합효과 모형에 대한 몬테카를로 시뮬레이션
시행방법입니다. 총 18조건에서 각 조건마다 1000개의 데이터 셋을
생성하였고 선형 혼합효과모형과 같이 maximal model인 m1과 m1의 영가설모델, random intercept만 있는 m2모형과 m2모형의 영가설모델을 만들었습니다. 그리고 maximal model인 m1 모형에 대한 Wald검정과 영가설 모델을 우도비검정으로 비교하였습니다. 또한 모형비교과정으로 m1, m2 모형 중 선택된 하나에 대한 Wald검정과 우도비검정을 실시하였습니다.

RMSE 그림을 보면 참가자수/문항 수가 작으면 추정값(estimation)이 부정확하므로 값이 커지고 참가자/문항 수가 늘어날수록 값이 작아집니다.

다음, 1종오류 비율은 유의수준을 0.05로 통제하므로 우도비검정이 wald검정보다 더 나은 수행을 보여 우도비검정이 wald 검정보다 선호된다는 것을 알 수 있습니다.

마지막으로 코헨은 성공적인 검정력의 기준을 80%로 제시하였습니다. 그림에서 보면 베타1인 고정효과 효과크기가 0.2일때보다 0.8이 더 크므로
검정력이 높습니다. 선형 혼합효과 모형은 일반화 선형 혼합효과 모형과 달리 intercept가 beta1인 고정효과 효과크기의 효과검증에 영향을 미칩니다.